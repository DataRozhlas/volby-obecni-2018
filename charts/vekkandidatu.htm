<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Highcharts Example</title>

		<style type="text/css">

		</style>
	</head>
	<body>

<wide><div style="max-width: 100%" id="vekkandidatu"></div></wide>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>

<script type="text/javascript">

var colors = ['#000000', '#808080', '#666666', '#b2b2b2', '#ffc900', '#ffe480', '#ff0000', '#ff7373', '#ff8e00', '#ffc173', '#0065ab', '#73aad1', '#2b2c5f', '#8a8ba7', '#00c9f1', '#80e4f8', '#a52a2a', '#d29494', '#755b7b', '#baadbd', '#000000', '#808080']

var dataVK = [
  [-2213,-1535,-4655,-8555,-11113,-12413,-16013,-18843,-24040,-18965,-13860,-9413,-4889,-1523],
  [965,645,2033,3710,5375,6098,7932,9084,11489,9334,6571,4321,2384,705],
  [-80,-306,-1287,-3171,-5051,-6146,-8404,-10486,-13944,-10997,-7763,-5165,-2365,-621],
  [25,82,481,1226,2204,2816,4034,4898,6627,5463,3749,2320,1184,303],
  [-49,-98,-285,-535,-727,-1024,-1190,-1321,-1598,-1314,-953,-644,-338,-114],
  [17,52,164,305,500,629,632,782,938,738,460,290,165,47],
  [-313,-540,-1446,-2101,-1577,-773,-679,-635,-815,-537,-331,-232,-164,-59],
  [160,271,656,942,760,446,387,383,383,303,163,125,84,22],
  [-80,-192,-486,-681,-818,-835,-1005,-1101,-1246,-980,-711,-513,-297,-86],
  [29,57,213,300,441,470,560,565,624,436,354,219,148,53],
  [-60,-120,-321,-523,-734,-931,-1178,-1301,-1394,-1032,-723,-522,-342,-105],
  [22,52,114,201,317,341,462,466,560,411,285,203,123,34],
  [-25,-62,-177,-324,-423,-482,-593,-714,-905,-742,-634,-382,-239,-83],
  [7,14,80,163,212,244,353,331,408,350,271,201,115,43],
  [-7,-23,-79,-196,-320,-444,-588,-681,-816,-632,-457,-277,-126,-36],
  [4,4,28,76,140,231,307,319,376,311,198,132,51,25],
  [-6,-31,-114,-192,-246,-267,-318,-338,-427,-318,-247,-213,-136,-62],
  [18,18,67,121,168,141,185,192,195,174,129,117,87,21],
  [0,-3,-7,-22,-38,-65,-99,-130,-220,-356,-429,-354,-203,-100],
  [0,6,8,15,31,56,55,67,97,133,192,144,94,35],
  [-4,-16,-37,-75,-163,-208,-273,-357,-428,-366,-257,-182,-140,-81],
  [3,7,23,38,81,80,142,144,169,130,87,85,47,26]
]

var stranyVK = ["celkem", "celkem, ženy", "SNK", "SNK, ženy", "KDU-ČSL", "KDU-ČSL, ženy", "KSČM", "KSČM, ženy", "ČSSD", "ČSSD, ženy", "ODS", "ODS, ženy", "ANO 2011", "ANO 2011, ženy",
"STAN", "STAN, ženy", "SPD", "SPD, ženy", "TOP 09", "TOP 09, ženy", "Piráti", "Pirátky"];

var run = 1;

Highcharts.chart('vekkandidatu', {
    chart: {
        type: 'bar'
    },
    title: {
        text: 'Věk kandidátů podle strany'
    },
    subtitle: {
        text: 'včetně koalic, rok 2018'
    },
    xAxis: [{
        categories: ["81+", "76-80", "71-75", "66-70", "61-65", "56-60", "51-55", "46-50", "41-45", "36-40", "31-35", "26-30", "21-25", "18-20"],
        reversed: true,
        labels: {
            step: 1
        }
    }, {
        categories: ["81+", "76-80", "71-75", "66-70", "61-65", "56-60", "51-55", "46-50", "41-45", "36-40", "31-35", "26-30", "21-25", "18-20"],
        opposite: true,
        reversed: true,
        linkedTo: 0,
        labels: {
            step: 1
        }
    }],
    yAxis: {
        title: {
            text: 'kandidáti v daném věku'
        },
        labels: {
            formatter: function () {
                return Math.abs(this.value);
            }
        }
    },
    tooltip: {
        formatter: function () {
            if(this.series.name.indexOf("ženy") !== -1) {
                return '<b>' + this.series.name + '</b><br/>' + this.x + ' let: ' + Math.abs(this.point.y) + ' kandidátů';
            } else if (this.series.name == "Pirátky" || this.series.name == "Piráti") {
                return '<b>' + this.series.name + '</b><br/>' + this.x + ' let: ' + Math.abs(this.point.y) + ' kandidátů';
            } else {
                return '<b>' + this.series.name + ', muži' + '</b><br/>' + this.x + ' let: ' + Math.abs(this.point.y) + ' kandidátů';
            }
        }
    },
    exporting: {
        enabled: false
    },
    credits: {
        href: 'https://volby.cz/',
        text: 'Zdroj: ČSÚ'
    },
    plotOptions: {
        series: {
            stacking: 'stacked',
            events: {
                show: function () {
                    if (run % 2 === 0) {
                        var chart = this.chart,
                            series = chart.series,
                            i = series.length,
                            otherSeries,
                            otherOtherSeries;

                        while (i--) {
                            otherSeries = series[i];
                            otherOtherSeries = series[i + 1];
                            if (otherSeries != this && otherSeries.visible && otherSeries.name.indexOf("ženy")  === -1 && otherSeries.name.indexOf("Pirátky")) {
                                otherSeries.hide();
                                otherOtherSeries.hide();
                            }
                        }
                    }
                    run = run + 1;
                },
                legendItemClick: function () {
                    if (this.visible) {
                        return false;
                    }
                }
            }
        }
    },
    series: [{
        name: stranyVK[0],
        data: dataVK[0],
        color: colors[0],
        visible: false
    }, {
        name: stranyVK[1],
        data: dataVK[1],
        color: colors[1],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[2],
        data: dataVK[2],
        color: colors[2],
        visible: false
    }, {
        name: stranyVK[3],
        data: dataVK[3],
        color: colors[3],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[4],
        data: dataVK[4],
        color: colors[4],
        visible: false
    }, {
        name: stranyVK[5],
        data: dataVK[5],
        color: colors[5],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[6],
        data: dataVK[6],
        color: colors[6]
    }, {
        name: stranyVK[7],
        data: dataVK[7],
        color: colors[7],
        linkedTo: ':previous'
    }, {
        name: stranyVK[8],
        data: dataVK[8],
        color: colors[8],
        visible: false
    }, {
        name: stranyVK[9],
        data: dataVK[9],
        color: colors[9],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[10],
        data: dataVK[10],
        color: colors[10],
        visible: false
    }, {
        name: stranyVK[11],
        data: dataVK[11],
        color: colors[11],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[12],
        data: dataVK[12],
        color: colors[12],
        visible: false
    }, {
        name: stranyVK[13],
        data: dataVK[13],
        color: colors[13],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[14],
        data: dataVK[14],
        color: colors[14],
        visible: false
    }, {
        name: stranyVK[15],
        data: dataVK[15],
        color: colors[15],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[16],
        data: dataVK[16],
        color: colors[16],
        visible: false
    }, {
        name: stranyVK[17],
        data: dataVK[17],
        color: colors[17],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[18],
        data: dataVK[18],
        color: colors[18],
        visible: false
    }, {
        name: stranyVK[19],
        data: dataVK[19],
        color: colors[19],
        linkedTo: ':previous',
        visible: false
    }, {
        name: stranyVK[20],
        data: dataVK[20],
        color: colors[20],
        visible: false
    }, {
        name: stranyVK[21],
        data: dataVK[21],
        color: colors[21],
        linkedTo: ':previous',
        visible: false
    }, {
        name: 'xxx',
        data: ['xxx'],
        visible: false,
        showInLegend: false
    }, {
        name: 'xxx',
        data: ['xxx'],
        visible: false,
        linkedTo: ':previous',
    }]
});

		</script>
	</body>
</html>

