<div class="b-data__bg" style="background-image: url('https://interaktivni.rozhlas.cz/brexit/media/cover.jpg');"><span class="b-data__caption">Foto <a href='#'>ČTK</a></span></div>
<header class="b-data__header">
<div class="row-main">
	<h1 class="b-data__title">
		<strong>XXX</strong>
	</h1>
	<p class="meta meta--lg">
	<!--[[ZPRAVY_SNOWFALL_AUTHORS:HEADER]]-->
	<span class="meta__separator">|</span>
	<time>21. dubna 2018</time>
	</p>	
	<p>
	<a href="#content" class="b-data__link js-scroll-to">
	Čtěte dále
	<span class="b-data__link-icon">
	<span class="icon-svg icon-svg--arrow-down">
	<svg class="icon-svg__svg" xmlns:xlink="http://www.w3.org/1999/xlink">
		<use xlink:href="/sites/all/themes/custom/irozhlas/img/bg/icons-svg.svg#icon-arrow-down" x="0" y="0" width="100%" height="100%"></use>
	</svg>
</span>
</span>
</a>
</p>
</div>
</header> 

<div class="b-data__content" id="content">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://d3js.org/d3-dsv.v1.min.js"></script>
<script src="https://d3js.org/d3-fetch.v1.min.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.dataTables.min.css">
<style>li{background:none !important}ul,ol{list-style:initial !important}hr{max-width:none !important}*{box-sizing:border-box}body{font:16px Arial}.autocomplete{position:relative;display:inline-block}input{border:1px solid transparent;background-color:#f1f1f1;padding:10px;font-size:16px}input[type=text]{background-color:#f1f1f1;width:90%}input[type=submit]{background-color:DodgerBlue;color:#fff}.autocomplete-items{position:absolute;border:1px solid #d4d4d4;border-bottom:0;border-top:0;z-index:99;top:100%;left:0;right:0}.autocomplete-items div{padding:10px;cursor:pointer;background-color:#fff;border-bottom:1px solid #d4d4d4}.autocomplete-items div:hover{background-color:#e9e9e9}.autocomplete-active{background-color:DodgerBlue !important;color:#fff}#obec,#strany,#kandidati{padding-bottom:30px}.stranaKlik{cursor:pointer}</style>
<div class="row-main row-main--narrow">

<p class="text-bold text-lg">XXX.</p>

<p></div><div class="row-main row-main--article"></p>
<div id="container">

<div id="obec">

<h3>Vyberte obec</h3>

<form autocomplete="off" action="/action_page.php">
  <div class="autocomplete" style="width:300px;">
    <input id="vyberObce" name="vyberObce" type="text" placeholder="Želechovice nad Dřevnicí (Zlín)">
  </div>
</form>

</div>

<div id="strany"><table id="tabulkaStran" class="display" style="width:100%"></table></div>

<div id="kandidati"><table id="tabulkaKandidatu" class="display" style="width:100%"></table></div>

</div>

<p class="meta meta--right meta--big">
<!--[[ZPRAVY_SNOWFALL_AUTHORS:FOOTER]]-->
</p>
</div>
<!--[[ZPRAVY_SNOWFALL_RELATED:ARTICLES]]-->
</div>
</article>
</div>
</div>
</div><script>
d3.csv("https://dev.datarozhlas.cz/volby-obecni-2018/data/kandidatky/app/obce/nazvyobci.csv").then(function(data){var nazvyObci=data;var seznamObci=nazvyObci.map(function(d){return d['NAZEVFULL'];});autocomplete(document.getElementById("vyberObce"),seznamObci);$("input").on("change",function(){setTimeout(function(){var zvolenaObec=document.getElementById("vyberObce").value;var index=seznamObci.indexOf(zvolenaObec);var idObce=nazvyObci[index]['KODZASTUP'];ukazStrany(zvolenaObec,idObce);},250);});});function ukazStrany(zvolenaObec,idObce){d3.csv("https://dev.datarozhlas.cz/volby-obecni-2018/data/kandidatky/app/strany/"+idObce+".csv").then(function(data){var strany=data;var idStran=strany.map(function(d){return d['StranaNr'];});var stranyBezId=strany.map(function(d){delete(d['StranaNr'])
return(d);});var html='<h3>Kandidující strany</h3>'
html+='(kliknutím na název strany zobrazíte kandidáty)'
html+='<table id="tabulkaStran" class="display" style="width:100%"></table>'
document.getElementById("strany").innerHTML=html;document.getElementById("kandidati").innerHTML='<div></div>';poskladejTabulkuStran(stranyBezId,idStran,idObce)
$(function(){$('#tabulkaStran').DataTable({"order":[[0,"asc"]],"responsive":true,"ordering":true,"paging":false,"bInfo":false,"language":{"url":"https://interaktivni.rozhlas.cz/tools/datatables/Czech.json"},});});})}
function ukazKandidaty(idObce,idStrany){d3.csv("https://dev.datarozhlas.cz/volby-obecni-2018/data/kandidatky/app/kandidati/"+idObce+".csv").then(function(data){var kandidati=data;var kandidatiBezId=kandidati.map(function(d){if(d['StranaNr']==idStrany){delete(d['StranaNr'])
delete(d['PREB'])
return(d);};});kandidatiBezId=kandidatiBezId.filter(function(d){return d!=undefined;});var html='<h3>Kandidáti</h3>'
html+='<table id="tabulkaKandidatu" class="display" style="width:100%"></table>'
document.getElementById("kandidati").innerHTML=html;poskladejTabulkuKandidatu(kandidatiBezId)
$(function(){$('#tabulkaKandidatu').DataTable({"order":[[0,"asc"]],"responsive":true,"ordering":true,"paging":false,"bInfo":false,"language":{"url":"https://interaktivni.rozhlas.cz/tools/datatables/Czech.json"},});});})}
function autocomplete(inp,arr){var currentFocus;inp.addEventListener("input",function(e){var a,b,i,val=this.value;closeAllLists();if(!val){return false;}
currentFocus=-1;a=document.createElement("DIV");a.setAttribute("id",this.id+"autocomplete-list");a.setAttribute("class","autocomplete-items");this.parentNode.appendChild(a);for(i=0;i<arr.length;i++){if(arr[i].substr(0,val.length).toUpperCase()==val.toUpperCase()){b=document.createElement("DIV");b.innerHTML="<strong>"+arr[i].substr(0,val.length)+"</strong>";b.innerHTML+=arr[i].substr(val.length);b.innerHTML+="<input type='hidden' value='"+arr[i]+"'>";b.addEventListener("click",function(e){inp.value=this.getElementsByTagName("input")[0].value;closeAllLists();});a.appendChild(b);}}});inp.addEventListener("keydown",function(e){var x=document.getElementById(this.id+"autocomplete-list");if(x)x=x.getElementsByTagName("div");if(e.keyCode==40){currentFocus++;addActive(x);}else if(e.keyCode==38){currentFocus--;addActive(x);}else if(e.keyCode==13){e.preventDefault();if(currentFocus>-1){if(x)x[currentFocus].click();}}});function addActive(x){if(!x)return false;removeActive(x);if(currentFocus>=x.length)currentFocus=0;if(currentFocus<0)currentFocus=(x.length-1);x[currentFocus].classList.add("autocomplete-active");}
function removeActive(x){for(var i=0;i<x.length;i++){x[i].classList.remove("autocomplete-active");}}
function closeAllLists(elmnt){var x=document.getElementsByClassName("autocomplete-items");for(var i=0;i<x.length;i++){if(elmnt!=x[i]&&elmnt!=inp){x[i].parentNode.removeChild(x[i]);}}}
document.addEventListener("click",function(e){closeAllLists(e.target);});}
function poskladejTabulkuStran(seznamStran,idStran,idObce){var columns=poskladejHlavickuStran(seznamStran);$('#tabulkaStran').append('<tbody>');for(var i=0;i<seznamStran.length;i++){var row$=$('<tr/>');for(var colIndex=0;colIndex<columns.length;colIndex++){var cellValue=seznamStran[i][columns[colIndex]];if(colIndex==0)cellValue='<p class="stranaKlik" onclick="ukazKandidaty('+idObce+', '+idStran[i]+')"><u>'+cellValue+'</u></p>';if(cellValue==null)cellValue="";row$.append($('<td/>').html(cellValue));}
$('#tabulkaStran').append(row$);}}
function poskladejHlavickuStran(seznamStran){var columnSet=[];$('#tabulkaStran').append('<thead id="seznamStranHlavicka">');var headerTr$=$('<tr>');for(var i=0;i<seznamStran.length;i++){var rowHash=seznamStran[i];for(var key in rowHash){if($.inArray(key,columnSet)==-1){columnSet.push(key);headerTr$.append($('<th/>').html(key));}}}
$('#seznamStranHlavicka').append(headerTr$);return columnSet;}
function poskladejTabulkuKandidatu(seznamKandidatu){var columns=poskladejHlavickuKandidatu(seznamKandidatu);$('#tabulkaKandidatu').append('<tbody>');for(var i=0;i<seznamKandidatu.length;i++){var row$=$('<tr>');for(var colIndex=0;colIndex<columns.length;colIndex++){var cellValue=seznamKandidatu[i][columns[colIndex]];if(cellValue==null)cellValue="";row$.append($('<td>').html(cellValue));}
$('#tabulkaKandidatu').append(row$);}}
function poskladejHlavickuKandidatu(seznamKandidatu){var columnSet=[];$('#tabulkaKandidatu').append('<thead id="seznamKandidatuHlavicka">');var headerTr$=$('<tr>');for(var i=0;i<seznamKandidatu.length;i++){var rowHash=seznamKandidatu[i];for(var key in rowHash){if($.inArray(key,columnSet)==-1){columnSet.push(key);headerTr$.append($('<th/>').html(key));}}}
$('#seznamKandidatuHlavicka').append(headerTr$);return columnSet;}</script>
